import { prisma } from "./../server";

async function main() {
  await prisma.$transaction(async (tx) => {
    await tx.userSavedRecipe.deleteMany();
    await tx.cookbook.deleteMany();
    await tx.favoriteRecipes.deleteMany();
    await tx.recipe.deleteMany();
    await tx.token.deleteMany();
    await tx.profile.deleteMany();
    await tx.user.deleteMany();

    const user = await tx.user.create({
      data: {
        id: "author_1",
        email: "kipe122006@gmail.com",
        passwordHash: "hashed_password_here",
        activationCode: "some-code",
        isActivated: true,
      },
    });

    const profiles = await tx.profile.createMany({
      data: [
        {
          name: "Kiryl Pekarski",
          userId: "author_1",
        },
      ],
    });

    const tokens = await tx.token.createMany({
      data: [
        {
          value: "refresh-token",
          userId: "author_1",
          expiresAt: "2025-06-01T12:00:00.000Z",
        }
      ]
    });

    const recipes = await tx.recipe.createMany({
      data: [
        {
          id: "recipe_1",
          title: "Борщ по-домашнему",
          description: "Борщ — это насыщенный свекольный суп, любимый во многих российских семьях. Его основа — мясной бульон, овощи, и, конечно, свёкла, придающая блюду характерный рубиновый цвет. Он подаётся горячим, часто со сметаной и свежим хлебом. При настаивании на следующий день борщ становится только вкуснее.",
          imageUrl: "http://localhost:5000/uploads/borsch.jpg",
          category: "SOUPS",
          difficulty: "MEDIUM",
          cuisine: "RUSSIAN",
          cookingTime: 90,
          ingredients: [
            "Говядина на кости — 500 г",
            "Свёкла — 2 шт.",
            "Морковь — 1 шт.",
            "Репчатый лук — 1 шт.",
            "Картофель — 3 шт.",
            "Капуста белокочанная — 200 г.",
            "Томатная паста — 2 ст. л.",
            "Чеснок — 2 зубчика",
            "Уксус 9% — 1 ст. л.",
            "Лавровый лист — 2 шт.",
            "Растительное масло — 2 ст. л.",
            "Соль, чёрный перец по вкусу",
            "Вода — 2,5 л"
          ],
          steps: [
            {
              title: "Варим бульон",
              time: 45,
              description: "В кастрюлю налить 2,5 литра воды, положить мясо, довести до кипения, снять пену. Варить на слабом огне 40–45 минут, посолив за 15 минут до готовности."
            },
            {
              title: "Подготовка овощей",
              time: 10,
              description: "Очистить и натереть свёклу и морковь, мелко нарезать лук. Картофель нарезать кубиками, капусту нашинковать."
            },
            {
              title: "Обжарка свёклы",
              time: 10,
              description: "В сковороде разогреть масло, обжарить свёклу с 1 ст. л. уксуса и томатной пастой 7–10 минут, помешивая."
            },
            {
              title: "Добавление овощей",
              time: 15,
              description: "В бульон добавить картофель и капусту, варить 10 минут. Затем добавить морковь и лук, варить ещё 5 минут."
            },
            {
              title: "Завершаем",
              time: 10,
              description: "Добавить свёклу, лавровый лист, измельчённый чеснок. Варить ещё 5–10 минут, затем снять с огня и дать настояться минимум 15 минут."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_2",
          title: "Драники с луком",
          description: "Белорусские драники — это румяные, хрустящие картофельные оладьи, которые подаются горячими со сметаной. Благодаря добавлению лука они приобретают насыщенный аромат и более нежную текстуру. Просты в приготовлении, но требуют внимания при жарке.",
          imageUrl: "http://localhost:5000/uploads/draniki.jpg",
          category: "MAIN_DISHES",
          difficulty: "EASY",
          cuisine: "BELARUSIAN",
          cookingTime: 30,
          ingredients: [
            "Картофель — 5 шт.",
            "Лук — 1 шт.",
            "Яйцо — 1 шт.",
            "Мука — 2 ст. л.",
            "Соль — по вкусу",
            "Чёрный перец — по вкусу",
            "Масло растительное — для жарки"
          ],
          steps: [
            {
              title: "Подготовка овощей",
              time: 10,
              description: "Картофель и лук очистить. Натереть на мелкой тёрке, массу слегка отжать от лишнего сока."
            },
            {
              title: "Формирование теста",
              time: 3,
              description: "К овощной массе добавить яйцо, муку, соль и перец. Хорошо перемешать до однородности."
            },
            {
              title: "Жарка",
              time: 15,
              description: "Разогреть сковороду с маслом. Ложкой выкладывать небольшие порции массы, придавая форму оладий. Жарить с двух сторон до золотистой корочки (по 3–4 минуты с каждой стороны)."
            },
            {
              title: "Подача",
              time: 2,
              description: "Выложить на бумажное полотенце, чтобы удалить лишнее масло. Подавать горячими со сметаной."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_3",
          title: "Селёдка под шубой",
          description: "Селёдка под шубой — знаменитый советский салат, украшение любого застолья. В нём гармонично сочетаются слои варёных овощей и филе сельди, промазанные майонезом. Окончательно салат 'раскрывается' после нескольких часов в холодильнике.",
          imageUrl: "http://localhost:5000/uploads/shuba.jpg",
          category: "SALADS",
          difficulty: "MEDIUM",
          cuisine: "RUSSIAN",
          cookingTime: 60,
          ingredients: [
            "Сельдь солёная (филе) — 1 шт.",
            "Картофель — 2 шт.",
            "Морковь — 2 шт.",
            "Свёкла — 2 шт.",
            "Яйца — 2 шт.",
            "Лук — 1 шт.",
            "Майонез — по вкусу",
            "Соль — по вкусу"
          ],
          steps: [
            {
              title: "Подготовка",
              time: 30,
              description: "Отварить картофель, морковь, свёклу и яйца. Остудить, очистить. Лук мелко нарезать, при желании можно ошпарить кипятком для смягчения."
            },
            {
              title: "Нарезка",
              time: 10,
              description: "Все ингредиенты (кроме лука) натереть на крупной тёрке по отдельным тарелкам. Сельдь нарезать мелкими кусочками."
            },
            {
              title: "Сборка салата",
              time: 15,
              description: "На большое плоское блюдо выложить слоями: картофель, сельдь с луком, морковь, яйца, свёкла. Каждый слой смазывать майонезом. Верхний слой — обязательно свекольный."
            },
            {
              title: "Настойка",
              time: 5,
              description: "Охладить салат перед подачей, лучше всего — на 2–4 часа в холодильнике."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_4",
          title: "Пельмени домашние",
          description: "Пельмени — одно из самых узнаваемых блюд русской кухни. Маленькие вареные изделия из тонкого теста с сочной мясной начинкой. Подаются горячими с бульоном, сметаной или уксусом.",
          imageUrl: "http://localhost:5000/uploads/pelmeni.jpg",
          category: "MAIN_DISHES",
          difficulty: "HARD",
          cuisine: "RUSSIAN",
          cookingTime: 120,
          ingredients: [
            "Мука — 500 г",
            "Яйцо — 1 шт.",
            "Вода — 200 мл",
            "Соль — 1 ч. л.",
            "Говядина — 250 г",
            "Свинина — 250 г",
            "Лук — 1 шт.",
            "Чеснок — 1 зубчик",
            "Перец чёрный молотый — по вкусу"
          ],
          steps: [
            {
              title: "Приготовление теста",
              time: 30,
              description: "Смешать муку с солью. Влить яйцо и воду, замесить упругое тесто. Завернуть в пленку и оставить на 30 минут."
            },
            {
              title: "Приготовление начинки",
              time: 20,
              description: "Мясо и лук пропустить через мясорубку. Добавить измельчённый чеснок, соль, перец и хорошо перемешать."
            },
            {
              title: "Формирование пельменей",
              time: 40,
              description: "Тесто раскатать тонко, вырезать кружки. В центр каждого положить начинку, сложить пополам и защипнуть края."
            },
            {
              title: "Варка",
              time: 20,
              description: "В кипящей подсоленной воде варить пельмени до всплытия и ещё 5–7 минут. Подавать горячими с бульоном или сметаной."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_5",
          title: "Котлеты по-киевски",
          description: "Котлета по-киевски — классическое блюдо русской кухни: сочное куриное филе с начинкой из сливочного масла и зелени, обжаренное до золотистой корочки.",
          imageUrl: "http://localhost:5000/uploads/kiev_cutlet.jpg",
          category: "MAIN_DISHES",
          difficulty: "HARD",
          cuisine: "RUSSIAN",
          cookingTime: 90,
          ingredients: [
            "Куриное филе — 4 шт.",
            "Сливочное масло — 100 г",
            "Петрушка — 20 г",
            "Чеснок — 1 зубчик",
            "Яйца — 2 шт.",
            "Мука — 100 г",
            "Панировочные сухари — 150 г",
            "Соль, перец — по вкусу",
            "Растительное масло — для жарки"
          ],
          steps: [
            {
              title: "Подготовка начинки",
              time: 10,
              description: "Сливочное масло размягчить, смешать с измельчённой петрушкой и чесноком. Сформировать из смеси брусочки и заморозить."
            },
            {
              title: "Подготовка филе",
              time: 20,
              description: "Куриное филе разрезать вдоль, не до конца, и отбить в пласт. В центр положить замороженное масло, завернуть филе, формируя котлету."
            },
            {
              title: "Панировка",
              time: 10,
              description: "Котлеты обвалять в муке, затем в взбитом яйце, затем в сухарях. Повторить панировку для плотной корочки."
            },
            {
              title: "Жарка",
              time: 15,
              description: "Обжарить котлеты в разогретом масле до золотистой корочки. Затем довести до готовности в духовке при 180°C около 15 минут."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_6",
          title: "Яблочный пирог",
          description: "Простой и вкусный яблочный пирог — классика русской домашней выпечки. Мягкое тесто и сочные яблоки с корицей делают его идеальным десертом к чаю.",
          imageUrl: "http://localhost:5000/uploads/apple_pie.jpg",
          category: "BAKERY_PRODUCTS",
          difficulty: "EASY",
          cuisine: "RUSSIAN",
          cookingTime: 60,
          ingredients: [
            "Яйца — 3 шт.",
            "Сахар — 1 стакан",
            "Мука — 1 стакан",
            "Разрыхлитель — 1 ч. л.",
            "Яблоки — 2–3 шт.",
            "Корица — по вкусу"
          ],
          steps: [
            {
              title: "Приготовление теста",
              time: 15,
              description: "Взбить яйца с сахаром до пышности. Добавить просеянную муку с разрыхлителем, аккуратно перемешать."
            },
            {
              title: "Подготовка яблок",
              time: 10,
              description: "Яблоки очистить от кожуры и сердцевины, нарезать дольками. При желании посыпать корицей."
            },
            {
              title: "Сборка пирога",
              time: 10,
              description: "Вылить тесто в смазанную форму, сверху равномерно выложить яблоки."
            },
            {
              title: "Выпекание",
              time: 25,
              description: "Выпекать в разогретой до 180°C духовке 25–30 минут до золотистой корочки. Проверить готовность деревянной шпажкой."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
        {
          id: "recipe_7",
          title: "Оладьи на кефире",
          description: "Пышные и нежные оладьи на кефире — идеальный завтрак или десерт. Готовятся быстро и просто, особенно вкусны со сметаной или вареньем.",
          imageUrl: "http://localhost:5000/uploads/oladyi.jpg",
          category: "BAKERY_PRODUCTS",
          difficulty: "EASY",
          cuisine: "RUSSIAN",
          cookingTime: 30,
          ingredients: [
            "Кефир — 500 мл",
            "Яйцо — 1 шт.",
            "Сахар — 2 ст. л.",
            "Соль — 0.5 ч. л.",
            "Мука — 2 стакана",
            "Сода — 1 ч. л.",
            "Растительное масло — для жарки"
          ],
          steps: [
            {
              title: "Приготовление теста",
              time: 10,
              description: "В миске смешать кефир, яйцо, сахар и соль. Добавить соду и муку, перемешать до однородного теста."
            },
            {
              title: "Жарка оладий",
              time: 15,
              description: "Разогреть сковороду с маслом. Выкладывать тесто ложкой, жарить с двух сторон до золотистой корочки."
            },
            {
              title: "Подача",
              time: 5,
              description: "Готовые оладьи выложить на бумажное полотенце, затем подавать горячими со сметаной или вареньем."
            }
          ],
          createdAt: new Date(),
          authorId: "author_1"
        },
      ]
    });

    const favoriteRecipes = await tx.favoriteRecipes.createMany({
      data: [
        {
          userId: "author_1",
          recipeId: "recipe_1",
        },
      ],
    });

    const cookbooks = await tx.cookbook.createMany({
      data: [
        {
          id: "cookbook_1",
          name: "Кулинарная книга №1",
          userId: "author_1",
        },
        {
          id: "cookbook_2",
          name: "Кулинарная книга №2",
          userId: "author_1",
        },
      ],
    });

    const userSavedRecipes = await tx.userSavedRecipe.createMany({
      data: [
        {
          cookbookId: "cookbook_1",
          userId: "author_1",
          recipeId: "recipe_1",
        },
        {
          cookbookId: "cookbook_2",
          userId: "author_1",
          recipeId: "recipe_1",
        },
        {
          cookbookId: "cookbook_1",
          userId: "author_1",
          recipeId: "recipe_2",
        },
        {
          cookbookId: "cookbook_1",
          userId: "author_1",
          recipeId: "recipe_3",
        },
      ]
    });
      
    console.log("All data seeded");
  })
}

main()
  .catch(e => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
